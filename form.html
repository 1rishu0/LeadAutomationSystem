<!DOCTYPE html>
<html>
<head>
    <title>Book a Test Drive</title>
    <style>
        body { font-family: Arial; max-width: 500px; margin: 50px auto; padding: 20px; }
        input, select { width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ddd; border-radius: 5px; }
        button { width: 100%; padding: 15px; background: #667eea; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; }
        button:hover { background: #5568d3; }
        .success { color: green; padding: 10px; background: #d4edda; border-radius: 5px; margin-top: 10px; }
        .error { color: red; padding: 10px; background: #f8d7da; border-radius: 5px; margin-top: 10px; }
    </style>
</head>
<body>
    <h2>üöó Book Your Test Drive</h2>
    <form id="leadForm">
        <input type="text" id="name" placeholder="Your Name" required>
        <input type="email" id="email" placeholder="Email Address" required>
        <input type="tel" id="phone" placeholder="Phone Number (+91-XXXXX-XXXXX)" required>
        <select id="car_model" required>
            <option value="">Select Car Model</option>
            <option value="Tata Nexon EV">Tata Nexon EV</option>
            <option value="Mahindra XUV700">Mahindra XUV700</option>
            <option value="Hyundai Creta">Hyundai Creta</option>
            <option value="Maruti Suzuki Swift">Maruti Suzuki Swift</option>
            <option value="Toyota Fortuner">Toyota Fortuner</option>
        </select>
        <input type="datetime-local" id="appointment" required>
        <button type="submit">Book Appointment</button>
    </form>
    <div id="message"></div>

    <script>
        document.getElementById('appointment').min = new Date().toISOString().slice(0, 16);

        document.getElementById('leadForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const data = {
                name: document.getElementById('name').value,
                email: document.getElementById('email').value,
                phone: document.getElementById('phone').value,
                car_model: document.getElementById('car_model').value,
                appointment_datetime: document.getElementById('appointment').value
            };

            const button = e.target.querySelector('button');
            button.disabled = true;
            button.textContent = 'Processing...';

            try {
                // CHANGE THIS LINE - Use your live Render URL
                const response = await fetch('https://lead-automation-system-px7x.onrender.com', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });

                const result = await response.json();
                const messageDiv = document.getElementById('message');

                if (result.success) {
                    messageDiv.className = 'success';
                    messageDiv.innerHTML = `‚úÖ Appointment booked successfully!<br>
                        Intent Score: ${result.intent_score}<br>
                        Meeting Link: <a href="${result.meet_link}" target="_blank">${result.meet_link}</a><br>
                        Check your email for confirmation.`;
                    e.target.reset();
                } else {
                    messageDiv.className = 'error';
                    messageDiv.textContent = '‚ùå ' + (result.errors.join(', ') || 'Something went wrong');
                }
            } catch (error) {
                document.getElementById('message').className = 'error';
                document.getElementById('message').textContent = '‚ùå Network error: ' + error.message;
            } finally {
                button.disabled = false;
                button.textContent = 'Book Appointment';
            }
        });
    </script>
</body>
</html>